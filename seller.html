<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seller Dashboard - Gamer's Auction</title>

<!-- Google Sign-In -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
body { margin:0; font-family: Arial, sans-serif; background:#f7f7f7; color:#111; }
header { background: #131921; padding:0.75rem 2rem; display:flex; justify-content:space-between; align-items:center; position:sticky; top:0; z-index:1000; }
header img { height: 65px; }
nav a { color:#fff; text-decoration:none; margin-left:1.5rem; font-weight:bold; transition:0.3s; }
nav a:hover { color:#ff9900; }
.g_id_signin { margin-left:1rem; }

.container { max-width:1000px; margin:2rem auto; background:#fff; padding:2rem; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
h2 { text-align:center; color:#ff9900; margin-bottom:1.5rem; }
.message { text-align:center; font-size:1.2rem; color:#b12704; margin-bottom:1rem; }

form label { display:block; margin-top:1rem; font-weight:bold; }
form input { width:100%; padding:0.75rem; margin-top:0.5rem; border:1px solid #ccc; border-radius:5px; font-size:1rem; }
form button { margin-top:1.5rem; background:#ff9900; color:white; border:none; padding:0.75rem 1.5rem; border-radius:5px; cursor:pointer; font-size:1rem; transition:transform 0.3s, background 0.3s; }
form button:hover { transform:scale(1.05); background:#e68a00; }

.product-list { display:flex; flex-wrap:wrap; gap:1rem; margin-top:1rem; }
.product-card { border:1px solid #ccc; border-radius:5px; padding:0.5rem; width:200px; text-align:center; background:#fff; }
.product-card img { width:100%; height:150px; object-fit:cover; border-radius:5px; }
.signout-btn { background:#d9534f; color:white; border:none; padding:0.5rem 1rem; border-radius:5px; cursor:pointer; float:right; margin-top:-50px; }
.signout-btn:hover { background:#c9302c; }
</style>
</head>
<body>

<header>
<img src="image_2025-09-09_095842205.png" alt="Gamer's Auction Logo">
<nav>
  <a href="index.html">Home</a>
  <a href="shop.html">Shop</a>
  <a href="cart.html">Cart</a>
  <a href="checkout.html">Checkout</a>
</nav>
<div id="googleSignIn" class="g_id_signin"></div>
</header>

<div class="container">
<h2>Seller Dashboard</h2>
<div id="signinMessage" class="message">Please sign in with Google to upload products.</div>
<button id="signOutBtn" class="signout-btn" style="display:none;">Sign Out</button>

<form id="productForm" style="display:none;">
  <label for="displayName">Display Name</label>
  <input type="text" id="displayName" required placeholder="Name visible to buyers">

  <label for="name">Product Name</label>
  <input type="text" id="name" required>

  <label for="price">Price</label>
  <input type="number" id="price" required>

  <label for="image">Product Image</label>
  <input type="file" id="image" accept="image/*" required>

  <button type="submit">Add Product</button>
</form>

<h3>Your Products</h3>
<div class="product-list" id="sellerProducts"></div>
</div>

<script>
let currentUser = JSON.parse(localStorage.getItem("currentUser") || "null");

// Google Sign-In callback
function handleCredentialResponse(response) {
  // Replace this with real JWT decoding if needed
  const email = "seller@example.com"; // for demo, normally decode JWT
  const name = "Seller Name";

  currentUser = { email, name };
  localStorage.setItem("currentUser", JSON.stringify(currentUser));
  document.getElementById("signinMessage").style.display = "none";
  document.getElementById("productForm").style.display = "block";
  document.getElementById("signOutBtn").style.display = "inline-block";
  loadSellerProducts();
}

// Sign Out
document.getElementById("signOutBtn").addEventListener("click", ()=>{
  localStorage.removeItem("currentUser");
  currentUser = null;
  document.getElementById("productForm").style.display = "none";
  document.getElementById("signinMessage").style.display = "block";
  document.getElementById("signOutBtn").style.display = "none";
});

window.onload = function(){
  if(currentUser){
    document.getElementById("signinMessage").style.display = "none";
    document.getElementById("productForm").style.display = "block";
    document.getElementById("signOutBtn").style.display = "inline-block";
    loadSellerProducts();
  }

  google.accounts.id.initialize({
    client_id: "189925870813-9ipif2qvi3vkv4f7lsh4p0e4kg644t64.apps.googleusercontent.com",
    callback: handleCredentialResponse
  });
  google.accounts.id.renderButton(
    document.getElementById("googleSignIn"),
    { theme:"outline", size:"large" }
  );
};

// Handle product upload
const form = document.getElementById("productForm");
const sellerProductsDiv = document.getElementById("sellerProducts");

form.addEventListener("submit", function(e){
  e.preventDefault();
  if(!currentUser) return alert("Sign in first");

  const displayName = document.getElementById("displayName").value;
  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;
  const file = document.getElementById("image").files[0];

  const reader = new FileReader();
  reader.onload = function(){
    const imageData = reader.result;
    const products = JSON.parse(localStorage.getItem("products")||"[]");

    products.push({
      id: Date.now(),
      name, price, image: imageData,
      seller: displayName,
      sellerId: currentUser.email,
      sold: false
    });

    localStorage.setItem("products", JSON.stringify(products));
    form.reset();
    loadSellerProducts();
  };
  reader.readAsDataURL(file);
});

function loadSellerProducts(){
  const products = JSON.parse(localStorage.getItem("products")||"[]");
  const myProducts = products.filter(p => p.sellerId === currentUser.email);

  sellerProductsDiv.innerHTML = "";
  if(myProducts.length === 0){
    sellerProductsDiv.innerHTML = "<p>You have not uploaded any products yet.</p>";
    return;
  }

  myProducts.forEach(p=>{
    const div = document.createElement("div");
    div.className = "product-card";
    div.innerHTML = `
      <img src="${p.image}" alt="${p.name}">
      <h4>${p.name}</h4>
      <p>â‚¹${p.price}</p>
      <div>Status: ${p.sold ? "Sold" : "Available"}</div>
    `;
    sellerProductsDiv.appendChild(div);
  });
}
</script>

</body>
</html>
